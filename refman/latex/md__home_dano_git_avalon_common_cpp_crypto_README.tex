\section*{Common Crypto library documentation }

This {\ttfamily common/cpp/crypto/} directory contains cryptographic code used by untrusted and trusted (Intel S\+GX Enclave) code.

This code is written in C++, but a Python wrapper is also available (see ../\+R\+E\+A\+D\+ME.md \char`\"{}../\+R\+E\+A\+D\+M\+E.\+md\char`\"{})

Avalon applications are free to use third-\/party cryptographic implementations (such as what a programming language binding may provide) or the cryptographic interfaces provided here.

\subsection*{Software Components Required }

Open\+S\+SL 1.\+1 library and Intel S\+GX Open\+S\+SL library built from Open\+S\+SL 1.\+1\+:


\begin{DoxyItemize}
\item \href{https://www.openssl.org/}{\tt https\+://www.\+openssl.\+org/}
\item \href{https://github.com/intel/intel-sgx-ssl}{\tt https\+://github.\+com/intel/intel-\/sgx-\/ssl}
\end{DoxyItemize}

\subsection*{Cryptographic Primitives Used }

\tabulinesep=1mm
\begin{longtabu} spread 0pt [c]{*{4}{|X[-1]}|}
\hline
\rowcolor{\tableheadbgcolor}\textbf{ Primitive }&\textbf{ Algorithm }&\textbf{ Keysize }&\textbf{ Comments  }\\\cline{1-4}
\endfirsthead
\hline
\endfoot
\hline
\rowcolor{\tableheadbgcolor}\textbf{ Primitive }&\textbf{ Algorithm }&\textbf{ Keysize }&\textbf{ Comments  }\\\cline{1-4}
\endhead
Digital signature &E\+C\+D\+S\+A-\/\+S\+E\+C\+P256\+K1 &256 &(1) (2) \\\cline{1-4}
Asymmetric encryption &R\+S\+A-\/\+O\+A\+EP &3072 &(1) \\\cline{1-4}
Authenticated encryption &A\+E\+S-\/\+G\+CM &256 &96b IV, 128b tag \\\cline{1-4}
Digest &S\+H\+A-\/256 &256 &(2) \\\cline{1-4}
Digest &K\+E\+C\+C\+A\+CK &256 &(2) Differs from S\+H\+A-\/3 \\\cline{1-4}
\end{longtabu}
(1) Not PQ resistant

(2) Blockchain legacy algorithm

\subsection*{Cryptographic Primitive Usage }


\begin{DoxyItemize}
\item {\bfseries S\+H\+A-\/256} Computing digests of the work order request and response
\item {\bfseries K\+E\+C\+C\+A\+K-\/256} Computing digests of the work order request and response or Ethereum raw transactions Packet bytes
\item {\bfseries A\+E\+S-\/\+G\+C\+M-\/256} Encrypts data items within work order request and response. It also used to encrypt a request digest and custom data encryption keys
\item {\bfseries R\+S\+A-\/\+O\+A\+E\+P-\/3072} Encrypt symmetric data encryption keys
\item {\bfseries E\+C\+S\+D\+A-\/\+S\+E\+C\+P256\+K1} Signs work order response digest and workerâ€™s encryption R\+S\+A-\/\+O\+A\+EP public key
\end{DoxyItemize}

\subsection*{Implementation of Cryptographic Elements }

Cryptographic elements include cryptographic keys, signature, ciphertexts, plaintexts, hashes, and random bitstrings.

\tabulinesep=1mm
\begin{longtabu} spread 0pt [c]{*{4}{|X[-1]}|}
\hline
\rowcolor{\tableheadbgcolor}\textbf{ Element }&\textbf{ Implementation }&\textbf{ Representation }&\textbf{ Serialize/\+Deserialize function?  }\\\cline{1-4}
\endfirsthead
\hline
\endfoot
\hline
\rowcolor{\tableheadbgcolor}\textbf{ Element }&\textbf{ Implementation }&\textbf{ Representation }&\textbf{ Serialize/\+Deserialize function?  }\\\cline{1-4}
\endhead
E\+C\+D\+SA public key &C++ class &Custom object &Yes, P\+EM encoding and 65-\/byte Bitcoin Hex format \\\cline{1-4}
E\+C\+D\+SA private key &C++ class &Custom object &Yes, P\+EM encoding \\\cline{1-4}
E\+C\+D\+SA signature &C++ string &D\+ER binary &No, user defined \\\cline{1-4}
R\+SA public key &C++ class &Custom object &Yes, P\+EM encoding \\\cline{1-4}
R\+SA private key &C++ class &Custom object &Yes, P\+EM encoding \\\cline{1-4}
R\+SA ciphertext &C++ string &raw binary &No, user defined \\\cline{1-4}
R\+SA plaintext &C++ string &raw binary &No, user defined \\\cline{1-4}
A\+E\+S-\/\+G\+CM key &C++ string &raw binary &No, user defined \\\cline{1-4}
A\+E\+S-\/\+G\+CM iv &C++ string &raw binary &No, user defined \\\cline{1-4}
A\+E\+S-\/\+G\+CM ciphertext+tag &C++ string &raw binary &No, user defined \\\cline{1-4}
A\+E\+S-\/\+G\+CM plaintext &C++ string &raw binary &No, user defined \\\cline{1-4}
S\+H\+A-\/256 digest &C++ string &raw binary &No, user defined \\\cline{1-4}
Random bitstring &C++ string &raw binary &No, user defined \\\cline{1-4}
\end{longtabu}
\subsection*{Security notes }


\begin{DoxyItemize}
\item {\bfseries A\+E\+S-\/\+G\+CM} When using of A\+E\+S-\/\+G\+CM inside Intel S\+GX enclaves to preserve confidentiality and integrity of data to be stored outside of the Intel S\+GX enclaves a different unique or random 12-\/byte IV must be used for each encrypted message. At most 2$^\wedge$32 distinct I\+Vs can be used until the key needs to be regenerated for security. This limitation can possibly be mitigated in the future by using alternatives to A\+E\+S-\/\+G\+CM like A\+E\+S-\/\+G\+CM S\+IV. 
\end{DoxyItemize}